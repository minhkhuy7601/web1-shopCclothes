<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Thông báo</title>
    <link rel="stylesheet" href="/vendor/bootstrap-4.5.3-dist/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="/vendor/bootstrap-4.5.3-dist/js/bootstrap.min.js"></script>
    <script src="https://kit.fontawesome.com/a076d05399.js"></script>
    <link rel="stylesheet" href="/resource/css/general.css">
    <style>
        #indents {
            display: flex;
            width: 80%;
            margin: 3rem auto;
            justify-content: space-around;
            padding-bottom: 6rem;
            border-bottom: 0.5rem double rgba(17, 45, 78, .6);
        }
        
        .infoIndent {
            width: 45%;
            border-right: 1px solid rgba(17, 45, 78, .3);
            background-color: rgba(63, 114, 175, .2);
            height: max-content;
            padding: 1rem 4rem;
        }
        
        #payment_box {
            padding: 1rem 4rem;
            width: 45%;
            background-color: rgba(17, 45, 78, .1);
            border-right: 1px solid rgba(17, 45, 78, .3);
            height: max-content;
        }
        
        .input {
            display: flex;
            align-items: center;
            width: 90%;
            margin: 1.5rem auto;
            min-height: 4rem;
            font-size: 1.5rem;
            border-radius: 0.5rem;
            border: 1px solid rgba(17, 45, 78, .3);
            padding-left: 2rem;
            background-color: rgb(249, 247, 247);
        }
        
        #section {
            padding-top: 5rem;
            min-height: 66rem;
        }
        
        .titleIndent {
            font-size: 2rem;
            font-weight: 700;
            width: 100%;
            text-align: center;
            padding: 1.5rem 0;
            border-bottom: 1px dashed rgba(17, 45, 78, .3);
        }
        
        #infoCart {
            border-bottom: 1px solid rgba(17, 45, 78, .3);
            padding: 1.5rem 0;
        }
        
        .product {
            display: flex;
            padding: 0.5rem 0;
            border-bottom: 1px dotted rgba(17, 45, 78, .3);
            height: 7.8rem;
        }
        
        #img {
            width: 15%;
            position: relative;
        }
        
        #img img {
            width: 100%;
        }
        
        #img span {
            position: absolute;
            right: -1rem;
            top: -.3rem;
            padding: .2rem .8rem;
            color: white;
            font-size: 1.3rem;
            border-radius: 50%;
            background-color: rgba(63, 114, 175, 1);
        }
        
        #infoProduct {
            width: 65%;
            padding-left: 1.5rem;
        }
        
        .priceProduct {
            width: 20%;
            color: rgba(17, 45, 78, .6);
        }
        
        #nameProduct,
        .priceProduct {
            font-size: 1.5rem;
            font-weight: 400;
            display: flex;
            align-items: center;
        }
        
        #describeProduct {
            font-size: 1.2rem;
            opacity: .5;
        }
        
        #couponDiscount {
            width: 100%;
            font-size: 1.5rem;
            border-bottom: 1px solid rgba(17, 45, 78, .3);
        }
        
        #paymentInfo,
        #totalCash {
            display: flex;
            width: 100%;
            margin: 0 auto;
        }
        
        #text {
            width: 80%;
            font-size: 1.5rem;
        }
        
        #textTotal {
            width: 80%;
            font-size: 2rem;
        }
        
        #priceProductTotal,
        .priceProductTotal,
        #priceProductTotal-waitPay {
            width: 20%;
            font-size: 2rem;
            color: rgba(63, 114, 175, 1);
        }
        
        .pay {
            padding: 1.5rem 0;
            border-bottom: 1px solid rgba(17, 45, 78, .3);
        }
        
        .btn-func {
            width: 100%;
            text-align: center;
        }
        
        .btn-func button {
            width: max-content;
            font-size: 1.6rem;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            background-color: rgba(17, 45, 78, .8);
            color: white;
            text-transform: uppercase;
        }
        
        #totalCash {
            padding: 1rem 0;
        }
        
        #noticeIndent {
            width: 100%;
        }
        
        .notice {
            width: 60%;
            display: flex;
            font-size: 2rem;
            align-items: center;
            font-weight: 700;
            background-image: linear-gradient(to right, rgba(17, 45, 78, .2), rgba(219, 226, 239, .3));
            border-radius: 0.5rem;
            box-shadow: 0.4rem -0.4rem rgba(17, 45, 78, .5);
            margin: 1rem auto;
            padding: 0.8rem 0;
        }
        
        #notice--btnDetail {
            width: 9%;
            border-radius: 0.5rem;
            font-weight: 700;
            background-color: rgba(63, 114, 175, .9);
            color: white;
        }
        
        .notice--state span {
            color: rgba(63, 114, 175, 1);
            width: 100%;
            text-align: left;
            ;
        }
        
        .seen {
            text-align: left;
            width: 100%;
        }
        
        .seen span {
            color: rgba(17, 45, 78, .5);
        }
        
        .notice--content {
            width: 55%;
            display: flex;
            flex-wrap: wrap;
        }
        
        .notice--content span {
            width: 100%;
        }
        
        .notice--state {
            width: 35%;
            padding: 0 1.5rem;
            display: flex;
            flex-wrap: wrap;
        }
        
        .notice--detailProduct {
            width: 80%;
            margin: 0 auto;
        }
        
        #nothing {
            font-size: 10rem;
            font-weight: 1000;
            text-align: center;
            /* padding: 12rem 0; */
            color: rgba(17, 45, 78, .3);
        }
        
        #section h6 {
            text-align: center;
            font-size: 3rem;
            text-transform: uppercase;
            font-weight: 800;
            margin-bottom: 4rem;
            letter-spacing: 0.5rem;
            color: rgba(17, 45, 78, .7);
        }
    </style>
</head>

<body>
    <header class="header">
        <div class="nav">
            <div class="nav__content">
                <a href="/resource/html/index.html"><img src="/img/logo.png" alt="logo" class="video_logo"></a>
                <div class="nav__content--icon">
                    <i class="fa fa-search icon icon__search">
                    <div action="" class="search">
                            <input type="text" placeholder="Tìm kiếm..." id="box_search">
                            <button type="submit" id="btn_search" onclick=""><i class="fa fa-search btn--search"></i></button>
                </div>
                </i>

                <a href="/resource/html/account.html" class="icon"><i class="fa fa-user"></i></a>
                <a href="/resource/html/cart.html" class="icon cart-head" id="boxNotification">
                    <img src="/img/cart-icon.png" alt="">
                    <span class="cart-count">0</span>
                </a>
            </div>
            <div class="nav__content--bar">
                <ul class="menu" id="menu-header">

                    <li>
                        <a href="/resource/html/genreProduct.html" onclick="getGenre('shop','null')">shop</a>
                        <ul class="menu__sub">
                            <li>
                                <a href="/resource/html/genreProduct.html" onclick="getGenre('top','null')">tops</a>
                                <ul class="menu__sub--s menu__sub--s1">
                                    <li><a href="/resource/html/genreProduct.html" onclick="getGenre('top','t_shirt')">t-shirt</a></li>
                                    <li><a href="/resource/html/genreProduct.html" onclick="getGenre('top','hoodie')">hoodies</a></li>
                                    <li><a href="/resource/html/genreProduct.html" onclick="getGenre('top','jacket')">jackets</a></li>
                                </ul>
                            </li>
                            <li>
                                <a href="/resource/html/genreProduct.html" onclick="getGenre('bottom','null')">bottom</a>
                                <ul class="menu__sub--s menu__sub--s2">
                                    <li><a href="/resource/html/genreProduct.html" onclick="getGenre('bottom','pant')">pants</a></li>
                                    <li><a href="/resource/html/genreProduct.html" onclick="getGenre('bottom','short')">shorts</a></li>
                                    <li><a href="/resource/html/genreProduct.html" onclick="getGenre('bottom','jean')">jeans</a></li>
                                </ul>
                            </li>
                            <li>
                                <a href="/resource/html/genreProduct.html" onclick="getGenre('bag','null')">bags</a>
                                <ul class="menu__sub--s menu__sub--s3">
                                    <li><a href="/resource/html/genreProduct.html" onclick="getGenre('bag','backpack')">backpacks</a></li>
                                    <li><a href="/resource/html/genreProduct.html" onclick="getGenre('bag','bowler_bag')">bowler bags</a></li>

                                </ul>
                            </li>
                        </ul>
                    </li>
                    <li><a href="#">about</a></li>
                    <li><a href="#">collections</a></li>
                    <li><a href="#">blogs</a></li>
                    <li><a href="#">contact</a></li>
                    <li><a href="#">sale!</a></li>


                </ul>
            </div>
        </div>
        </div>
        <!-- <div id="btn-addRemoveProduct">
            <div class="Re_Add btn-add">
                XXX
                <ul>
                    <li><a href="/resource/html/addProduct_Admin.html">ADD PRODUCT</a></li>
                    <li><a href="/resource/html/admin.html">REMOVE PRODUCT</a></li>
                    <li>ADD DISCOUNT</li>
                </ul>
            </div>
        </div> -->
    </header>
    <section id="section">
        <h6>Thông báo</h6>

        <div id="noticeIndent">
            <div id="nothing"></div>
        </div>
    </section>

    <footer class="footer">
        <div class="modal fade" id="myModal" role="dialog">
            <div class="modal-dialog" id="modal-discount">
                <div class="modal-content" id="modal-content-discount">
                    <input id="nameDisccount" type="text" placeholder="Tên mã giảm giá">
                    <input id="CostDisscont" type="text" placeholder="Số tiền giảm giá">
                    <input id="amountDisscount" type="text" placeholder="Số lượng mã">
                    <input id="codeDisscount" type="text" placeholder="Nhập mã code...(Tối da 10 ký tự)">
                    <div id="btnModalDiscount">
                        <button type="button" data-dismiss="modal">Close</button>
                        <button type="button" id="yesSetDisscont" onclick="setDiscount()">yes</button>
                    </div>

                </div>
            </div>
        </div>
        <div class="row footer__row">
            <div class="col-sm-4">
                <div class="col2">
                    <h2 class="footer__col--title">Hệ thống cửa hàng</h2>
                    <ul class="menu--address">
                        <li>
                            <i class="fas fa-map-marker-alt"></i> Chi nhánh Hà Nội
                        </li>
                        <p>
                            121 Phố Huế, Hai Bà Trưng, Hà Nội <br> Tầng 7 Vincom Bà Triệu, Hai Bà Trưng, Hà Nội <br> 28 Khúc Thừa Dụ, Dịch Vọng, Cầu Giấy
                        </p>
                        <li>
                            <i class="fas fa-map-marker-alt"></i> Chi nhánh Hồ Chí Minh
                        </li>
                        <p>
                            41 Quang Trung, Phường 10, Quận Gò Vấp, TP.Hồ Chí Minh <br> 7 Huỳnh Khương Ninh, Phường Đakao, Quận 1, TP. Hồ Chí Minh <br> 132 Nguyễn Sơn, Phường Phú Thọ Hòa, Quận Tân Phú, TP.Hồ Chí Minh <br> 136 Nguyễn Hồng Đào, Phường 14
                            , Tân Bình , TP. Hồ Chí Minh
                        </p>
                        <li><i class="fas fa-map-marker-alt"></i> Chi nhánh Cần Thơ
                        </li>
                        <p>52 Mậu Thân Ninh Kiều - Cần Thơ</p>
                        <li><i class="fas fa-map-marker-alt"></i> Chi nhánh An Giang</li>
                        <p><i class="fas fa-phone"></i> 0377738029 <br><i class="fa fa-envelope"></i> minhkhuy7601@gmail.com</p>
                    </ul>
                </div>
            </div>
            <div class="col-sm-4">
                <div class="col1">
                    <div class="footer_box--logo">
                        <img src="/img/logoWhite1.png" alt="logo" class="footer--logo">
                        <div class="footer__content">Lorem ipsum, dolor sit amet consectetur adipisicing elit. Repudiandae, quidem?</div>
                        <div style=" margin: 1rem;  font-size: 1.8rem; padding: 0 2rem;">
                            <input id="feedback" type="text" style="width: 35rem; height: 5rem; padding: 0 2rem;" placeholder="Đóng góp ý kiến...">
                            <button style=" height: 5rem; padding: 0 1rem;  font-weight: 600;">Send</button>

                        </div>
                    </div>
                </div>
            </div>
            <div class="col-sm-4">
                <div class="col3">
                    <h2 class="footer__col--title">Mạng xã hội</h2>
                    <img src="/img/fb_icon.png" alt="fb">
                    <a href="https://www.instagram.com/dirtycoins.vn/?hl=vi"><img src="/img/insta_icon.png" alt=""></a>
                    <img src="/img/pin.png" alt="">
                    <a href="https://www.youtube.com/channel/UCxLwKCNi6FoZ0lKu6k3qFGA"><img src="/img/yt.png" alt=""></a><br><br><br>
                    <iframe src="https://www.facebook.com/plugins/page.php?href=https%3A%2F%2Fwww.facebook.com%2FDirtyCoins.VN&tabs&width=340&height=214&small_header=false&adapt_container_width=true&hide_cover=false&show_facepile=true&appId" width="340" height="214" style="border:none;overflow:hidden"
                        scrolling="no" frameborder="0" allowTransparency="true" allow="encrypted-media"></iframe>
                </div>
            </div>
        </div>
        <div class="author">Web1 @ 2020 by NTK</div>

    </footer>
    <script src="/resource/js/data.js"></script>
    <script src="/resource/js/country.js"></script>
    <script>
        onLoadCartNumbers();

        function displayNotification() {
            if (currentAccount.notice.length == 0) {
                document.getElementById("nothing").textContent = "NOTHING";
            } else {
                document.getElementById("nothing").textContent = "";
            }
            let noticeIndent = document.getElementById("noticeIndent");
            for (let i = currentAccount.notice.length - 1; i >= 0; i--) {
                noticeIndent.innerHTML += `<div class="notice">
                <div class="notice--state" id="notice--state--${i}">Đơn hàng #${currentAccount.notice[i].idIndent} <span id="notice--state--span--${i}">(${currentAccount.notice[i].state})</span><div class="seen" id="seen--${i}"></div></div>
                <div class="notice--content" id="notice--content--${i}"></div>
                <button id="notice--btnDetail" onclick="showDetail(${i})">Chi tiết</button>
            </div>
            <div class="notice--detailProduct" id="notice--detailProduct--${i}"></div>
            `;
                for (let j = 0; j < currentAccount.notice[i].product.length; j++) {
                    document.getElementById("notice--content--" + i).innerHTML += `<span>${currentAccount.notice[i].product[j].name}</span>`;
                }
                seenNotice(i);
            }

        }
        displayNotification();

        function seenNotice(i) {
            if (currentAccount.notice[i].seen == true) {
                document.getElementsByClassName("notice")[currentAccount.notice.length - i - 1].style = "font-weight: 500";
                document.getElementById("seen--" + i).innerHTML = `<span>Đã xem</span>`;
            } else {
                document.getElementsByClassName("notice")[currentAccount.notice.length - i - 1].style = "font-weight: 700";
                document.getElementById("seen--" + i).innerHTML = '';
            }
        }

        function showDetail(i) {
            if (currentAccount.notice[i].stateDisplay == false) {
                currentAccount.notice[i].seen = true;
                seenNotice(i);
                console.log(currentAccount.notice[i].seen);
                accounts[currentAccount.id] = currentAccount;
                localStorage.setItem('currentAccount', JSON.stringify(currentAccount));
                localStorage.setItem('allAccount', JSON.stringify(accounts));
                notification();

                document.getElementById("notice--detailProduct--" + i).innerHTML = `<div id="indents">
            <div class="infoIndent" id="infoIndent--${i}">
                <h2 class="titleIndent">Thông tin đơn hàng</h2>
                <div class="input">Mã đơn hàng: ${currentAccount.notice[i].idIndent}  </div>
                <div class="input">Họ và tên: ${currentAccount.notice[i].nameCustomer}  </div>
                <div class="input">Email: ${currentAccount.notice[i].email}</div>
                <div class="input">SĐT: ${currentAccount.notice[i].numPhone}</div>
                 <div class="input">Địa chỉ: ${currentAccount.notice[i].address}</div>
                <div class="input">Ghi chú: ${currentAccount.notice[i].note} </div>  
                <div class="input">Ngày mua hàng: ${currentAccount.notice[i].dateBuy} </div>            

            </div>
            <div id="payment_box">
                <h2 class="titleIndent">Đơn hàng</h2>
                <div id="infoCart-notice--${i}">
                </div>
                <div id="couponDiscount">
                    <div class="input" id="couponDiscount--${i}">Mã giảm giá đã nhập:</div>
                </div>
                <div class="pay" id="pay--${i}">
                    <div id="paymentInfo">
                        <div id="text">Tạm tính</div>
                        <div class="priceProduct" id="priceTotalTemp-notice--${i}">${currentAccount.notice[i].priceTotalTemp}₫</div>

                    </div>
                    <div id="paymentInfo">
                        <div id="text">Vận chuyển (Thanh toán khi nhận hàng)</div>
                        <div class="priceProduct" id="priceTrans-notice--${i}">${currentAccount.notice[i].priceTrans}₫</div>

                    </div>
                </div>
                <div id="totalCash">
                    <div id="textTotal" >Tổng cộng</div>
                    <div class="priceProductTotal" id="priceProductTotal-notice--${i}">${currentAccount.notice[i].priceProductTotal}₫</div>
                </div>
                <div class="btn-func" id="btn-func--${i}">
                </div>
            </div>
            
        </div>
        `
                if (currentAccount.notice[i].discount.nameDiscount != null) {
                    document.getElementById("pay--" + i).innerHTML += ` <div id="paymentInfo">
                <div id="text" class="nameDiscount">Mã ${currentAccount.notice[i].discount.nameDiscount}</div>
                <div class="priceProduct" id="priceDisscount">-${currentAccount.notice[i].discount.priceDiscount}₫</div>
            </div>`
                    document.getElementById("couponDiscount--" + i).innerText += " " + currentAccount.notice[i].discount.codeDiscount;
                }
                if (currentAccount.notice[i].state == 'Chờ thanh toán' || currentAccount.notice[i].state == 'Đã thanh toán') {
                    document.getElementById("btn-func--" + i).innerHTML = `<button>${currentAccount.notice[i].state}</button>`;
                }
                if (currentAccount.notice[i].state == 'Chờ xác nhận') {
                    document.getElementById("btn-func--" + i).innerHTML = `<button onclick="confirmIndent(${i})">Xác nhận</button>`;
                }
                if (currentAccount.notice[i].dateConfirm != null) {
                    document.getElementById("infoIndent--" + i).innerHTML += `<div class="input">Ngày xác nhận: ${currentAccount.notice[i].dateConfirm} </div>`

                }
                if (currentAccount.notice[i].datePay != null) {
                    document.getElementById("infoIndent--" + i).innerHTML += `<div class="input">Ngày thanh toán: ${currentAccount.notice[i].datePay} </div>`

                }
                let infoCart_notice = document.getElementById("infoCart-notice--" + i);

                for (let k = 0; k < currentAccount.notice[i].product.length; k++) {
                    infoCart_notice.innerHTML += `<div class="product">
                        <div id="img"><img src="${currentAccount.notice[i].product[k].img}" alt=""><span>${currentAccount.notice[i].product[k].incart}</span></div>
                        <div id="infoProduct">
                            <div id="nameProduct">${currentAccount.notice[i].product[k].name}</div>
                            <div id="describeProduct"></div>
                        </div>
                        <div class="priceProduct">${currentAccount.notice[i].product[k].incart*currentAccount.notice[i].product[k].price}₫</div>
                    </div>`
                }

                currentAccount.notice[i].stateDisplay = true;
            } else {
                document.getElementById("notice--detailProduct--" + i).innerHTML = '';
                currentAccount.notice[i].stateDisplay = false;

            }

        }

        function scrollProduct() {
            let productIndent = document.getElementsByClassName("product")[0].offsetHeight;

            let infoCart = document.querySelectorAll("#infoCart");
            for (let i = 0; i < infoCart.length; i++) {
                if (infoCart[i].offsetHeight > productIndent * 3) {
                    infoCart[i].style.height = (productIndent + 6) * 3 + "px";
                    infoCart[i].style.overflowY = "scroll";
                }
            }
        }

        function confirmIndent(i) {
            var today = new Date();
            var date = today.getFullYear() + '-' + (today.getMonth() + 1) + '-' + today.getDate();
            var time = today.getHours() + ":" + today.getMinutes() + ":" + today.getSeconds();
            var dateTime = date + ' ' + time;
            currentAccount.notice[i].state = "Chờ thanh toán";
            currentAccount.notice[i].dateConfirm = dateTime;
            accounts[currentAccount.id] = currentAccount;
            let idAcc = currentAccount.notice[i].idIndent.slice(0, 5);
            for (let j = 0; j < accounts.length; j++) {
                if (accounts[j].idAccount == idAcc) {
                    for (let k = 0; k < accounts[j].cart.length; k++) {
                        if (accounts[j].cart[k].idIndent == currentAccount.notice[i].idIndent)
                            accounts[j].cart[k] = currentAccount.notice[i];
                    }
                }

            }
            localStorage.setItem('currentAccount', JSON.stringify(currentAccount));
            localStorage.setItem('allAccount', JSON.stringify(accounts));

            document.getElementById("infoIndent--" + i).innerHTML += `<div class="input">Ngày xác nhận: ${currentAccount.notice[i].dateConfirm} </div>`
            document.getElementById("btn-func--" + i).innerHTML = `<button class="btn-confirm">${currentAccount.notice[i].state}</button>`;
            document.getElementById("notice--state--span--" + i).textContent = "(" + currentAccount.notice[i].state + ")";
        }

        function confirm(indexInAccount, indexInWaitConfirm) {
            var today = new Date();
            var date = today.getFullYear() + '-' + (today.getMonth() + 1) + '-' + today.getDate();
            var time = today.getHours() + ":" + today.getMinutes() + ":" + today.getSeconds();
            var dateTime = date + ' ' + time;
            accounts[indexInAccount].waitConfirm[indexInWaitConfirm].dateConfirm = dateTime;
            accounts[indexInAccount].waitPay.push(accounts[indexInAccount].waitConfirm[indexInWaitConfirm]);
            accounts[indexInAccount].waitConfirm.splice(indexInWaitConfirm, 1);
            localStorage.setItem('allAccount', JSON.stringify(accounts));
            console.log("btn-func-" + indexInAccount + "-" + indexInWaitConfirm);
            document.getElementById("btn-func-" + indexInAccount + "-" + indexInWaitConfirm).innerHTML = `<button class="btn-confirm">Chờ thanh toán</button>`;
        }
    </script>
</body>

</html>